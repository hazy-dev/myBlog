<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.study.blog.mapper.MenuMapper">
	
	<select id="menu_list" parameterType="hashmap" resultType="Menu">
	
		SELECT A.IDX, A.MENU, A.MOVE, B.NAME, A.MENU_AUTH, A.SEQ, A.HIDE FROM MENU_TABLE A JOIN ADMIN B
		ON A.AUTH = B.AUTH 
		<if test="auth_group == 1" >
			WHERE A.AUTH = #{auth}
		</if>
	
	</select>
	
	<select id="max_seq" resultType="int">
	
		<!-- SELECT MAX(SEQ) + 1 AS CNT FROM MENU_TABLE -->
		SELECT MAX(SEQ) AS CNT FROM MENU_TABLE
	
	</select>
	
	<update id="update_menu_auth" parameterType="hashmap">
	
		UPDATE MENU_TABLE SET MENU_AUTH = #{menu_auth} WHERE IDX = #{idx}
	
	</update>
	
	<update id="update_menu_seq" parameterType="hashmap">
	
		UPDATE MENU_TABLE SET SEQ = ${seq} WHERE IDX = #{idx}
	
	</update>
	
	<update id="update_menu_hide" parameterType="hashmap">
	
		UPDATE MENU_TABLE SET HIDE = '${hide}' WHERE IDX = #{idx}
	
	</update>
	
	<select id="menu_check" parameterType="hashmap" resultType="int">
	
		SELECT COUNT(*) FROM MENU_TABLE WHERE MENU = #{menu}
	
	</select>
	
	<select id="menu_move_check" parameterType="hashmap" resultType="int">
	
		SELECT COUNT(*) FROM MENU_TABLE WHERE MOVE = #{move}
	
	</select>
	
	<insert id="MENU_INSERT" parameterType="hashmap">
	
		INSERT INTO MENU_TABLE ( MENU, MOVE, AUTH, MENU_AUTH, SEQ, HIDE ) 
		VALUES ( #{menu} , #{move} , #{admin_selectbox}, #{menu_auth_selectbox}, 
		#{max_seq} , #{hide_selectbox} )
	
	</insert>
	
	
</mapper>